!function(t){t.fn.wmPhotoset=function(){return this.each(function(){function o(){var t=window,o="inner";return"innerWidth"in window||(o="client",t=document.documentElement||document.body),{width:t[o+"Width"],height:t[o+"Height"]}}function e(){t("#wm-photoset .about_photo").click(function(){t(this).hasClass("caption_open")?(t("#wm-photoset").animate({height:r}),t("#wm-photoset .about_photo").removeClass("caption_open")):(t("#wm-photoset .about_photo").addClass("caption_open"),t("#wm-photoset").animate({height:r+t("#wmphotoset-caption-slider").outerHeight()+s}))})}function i(o,e){0==o&&(o=t("#wm-photoset li:nth-child("+e+") img").outerHeight()),heightCaption=t("#wm-photoset li:nth-child("+e+") .wmphotoset-caption").css("height","auto").innerHeight(),r=o+heightCaption,t("#wm-photoset li:nth-child("+e+") .wmphotoset-caption").hasClass("single-photo")||(r+=s),t("#wm-photoset").animate(t("#wm-photoset li:nth-child("+e+") .about_photo").hasClass("caption_open")&&t("#wmphotoset-caption-slider").length>0?{height:r+t("#wmphotoset-caption-slider").outerHeight()+s}:{height:r})}function n(){t("#prev-photo").removeAttr("disabled"),t("#next-photo").removeAttr("disabled"),1==w?t("#prev-photo").attr("disabled","disabled"):w==l&&t("#next-photo").attr("disabled","disabled")}function p(e){1>e?e=1:e>l&&(e=l),t("#wm-photoset li").fadeOut(400,function(){c=o().width,940>=c&&(nav=t("#wm-photo-nav").detach(),slider=t("#wm-photoset #wmphotoset-caption-slider").detach(),t("#wm-photoset li:nth-child("+e+") .wmphotoset-caption").before(nav).after(slider),theCaption=t("#wm-photoset li:nth-child("+e+") .wmphotoset-caption .wmphotoset-caption-text").clone().show(),t("#wm-photoset #wmphotoset-caption-slider").empty().append(theCaption))}),t("#wm-photo-nav .current_pg_num").text(e),t("#wm-photoset li:nth-child("+e+")").fadeIn(),t("#wm-photo-nav a").removeClass("active"),t("#wm-photo-nav a:nth-child("+e+")").addClass("active"),w=e,n(),i(0,e)}function h(){c=o().width,c>940?t(".about_photo").length>0&&(nav=t("#wm-photo-nav").detach(),t("#wm-photoset").append(nav),t("#wm-photoset li .wmphotoset-caption .wmphotoset-caption-text").show(),t("#wmphotoset-caption-slider").remove(),t(".about_photo").remove()):(pos=1,l>1&&(photoIndex=parseInt(t("#pagination a.active").attr("name").substr(10)),0==t(".about_photo").length&&(t("#wm-photoset li .wmphotoset-caption").append('\n<button class="about_photo">about this photo</button>'),e(),nav=t("#wm-photo-nav").detach(),t("#wm-photoset li:nth-child("+photoIndex+") .wmphotoset-caption").after('\n<div id="wmphotoset-caption-slider"></div>'),t("#wm-photoset li:nth-child("+photoIndex+") .wmphotoset-caption").before(nav),t("#wm-photoset li .wmphotoset-caption .wmphotoset-caption-text").hide(),theCaption=t("#wm-photoset li:nth-child("+photoIndex+") .wmphotoset-caption .wmphotoset-caption-text").clone().show(),t("#wm-photoset #wmphotoset-caption-slider").empty().append(theCaption)),pos=photoIndex),i(0,pos))}var a=t(".lt-ie8").length>0,s=10,c=o().width,d=265/475,m=272;505>=c&&(m=Math.round(c*d)-10);var l=t("#wm-photoset li").length;if(1==l)t(this).addClass("single-photo"),i(m,1);else{var w=1,r=0;t("#wm-photoset li").hide(),t("#wm-photoset li").first().show();var u='\n<button id="prev-photo"></button>',v='\n<button id="next-photo"></button>';for(pagination='\n<div id="pagination">',j=1;l>=j;j++)pagination+='\n    <a name="goto-photo'+j+'"',pagination+=">"+j+"</a> ";pagination+='\n</div>\n<div id="pg_ratio">\n    <span class="current_pg_num">1</span> / \n    <span class="total_pg_num">'+l+"</span>\n</div>",c>940&&!a?t(this).append('\n<div id="wm-photo-nav">'+u+v+pagination+"</div>"):(t("#wm-photoset li .wmphotoset-caption .wmphotoset-caption-text").hide(),t("#wm-photoset li .wmphotoset-caption").append('\n<button class="about_photo">about this photo</button>'),e(),t("#wm-photoset li:first-child .wmphotoset-caption").before('\n<div id="wm-photo-nav">'+u+v+pagination+"</div>"),firstCaption=t("#wm-photoset li:first-child .wmphotoset-caption .wmphotoset-caption-text").clone().show(),t("#wm-photoset li:first-child .wmphotoset-caption").after('\n<div id="wmphotoset-caption-slider"></div>'),t("#wm-photoset #wmphotoset-caption-slider").append(firstCaption),i(m,1)),n(),t("#wm-photo-nav a:first-child").addClass("active"),t("#pagination a").click(function(){p(parseInt(t(this).attr("name").substr(10)))}),t("#prev-photo").click(function(){p(w-1)}),t("#wm-photoset li img").swipe({excludedElements:"button, input, select, textarea, .noSwipe",swipeLeft:function(){p(w+1)},swipeRight:function(){p(w-1)},tap:function(o,e){t(e).closest("a").length>0&&window.open(t(e).closest("a").attr("href"),"_self")}}),t("#next-photo").click(function(){p(w+1)})}var f=!1,g=250;t(window).resize(function(){clearTimeout(f),f=setTimeout(function(){h()},g)})})}}(jQuery);